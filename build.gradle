plugins {
    id "java"
    id "org.springframework.boot" version "3.1.2"
    id "io.spring.dependency-management" version "1.1.3"
}

group = "me.ghostbear"
version = "2023.07"

java {
    sourceCompatibility = JavaVersion.VERSION_20.toString()
    targetCompatibility = JavaVersion.VERSION_20.toString()
}

springBoot {
    buildInfo()
}

// Use a known archive name for Docker builds
if (Objects.nonNull(System.getenv("DOCKER_PIPELINE")) && System.getenv("DOCKER_PIPELINE").toBoolean()) {
    bootJar.configure {
        archiveFileName.set("kumaslash.jar")
    }
}

repositories {
    mavenCentral()
}

dependencies {
    developmentOnly "org.springframework.boot:spring-boot-devtools"
    developmentOnly "org.springframework.boot:spring-boot-docker-compose"

    implementation "com.discord4j:discord4j-core:3.2.5"
    implementation "ch.qos.logback:logback-classic:1.4.8"

    implementation "org.springframework.boot:spring-boot-starter-webflux"
    implementation "org.springframework.boot:spring-boot-starter-data-r2dbc"
    implementation "org.springframework.boot:spring-boot-starter-graphql"

    implementation "org.flywaydb:flyway-core"
    implementation "org.apache.commons:commons-lang3"

    runtimeOnly "org.postgresql:postgresql"
    runtimeOnly "org.postgresql:r2dbc-postgresql"
}
