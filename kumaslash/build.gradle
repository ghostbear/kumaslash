plugins {
    id "java"
    id "org.springframework.boot"
    id "io.spring.dependency-management"
}

springBoot {
    buildInfo()
}

// Use a known archive name for Docker builds
if (Objects.nonNull(System.getenv("DOCKER_PIPELINE")) && System.getenv("DOCKER_PIPELINE").toBoolean()) {
    bootJar.configure {
        archiveFileName.set("kumaslash.jar")
    }
}

dependencies {
    developmentOnly "org.springframework.boot:spring-boot-devtools"
    developmentOnly "org.springframework.boot:spring-boot-docker-compose"

    implementation "com.discord4j:discord4j-core:3.2.6"
    implementation "ch.qos.logback:logback-classic:1.4.11"

    implementation "org.springframework.boot:spring-boot-starter-webflux"
    implementation "org.springframework.boot:spring-boot-starter-data-r2dbc"

    implementation "org.flywaydb:flyway-core"
    implementation "org.apache.commons:commons-lang3"

    runtimeOnly "org.postgresql:postgresql"
    runtimeOnly "org.postgresql:r2dbc-postgresql"

    implementation project(":core-discord4j")
    implementation project(":service-anilist")
    implementation project(":service-core")
    implementation project(":service-guild")
    implementation project(":service-tachiyomi")
}
